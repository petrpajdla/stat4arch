<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>stat4arch – seminar6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">stat4arch</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target=""><i class="bi bi-house-heart" role="img">
</i> 
 <span class="menu-text">Course overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html" rel="" target=""><i class="bi bi-calendar4" role="img">
</i> 
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="dropdown-header"><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Lectures</span></li>
  <li class="nav-item">
    <a class="nav-link" href="../../project.html" rel="" target=""><i class="bi bi-file-earmark-code" role="img">
</i> 
 <span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html" rel="" target=""><i class="bi bi-gear" role="img">
</i> 
 <span class="menu-text">Resources</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#stat4arch" id="toc-stat4arch" class="nav-link active" data-scroll-target="#stat4arch">stat4arch</a></li>
  <li><a href="#seminar-6" id="toc-seminar-6" class="nav-link" data-scroll-target="#seminar-6">Seminar 6</a></li>
  <li><a href="#but-first-an-exercise" id="toc-but-first-an-exercise" class="nav-link" data-scroll-target="#but-first-an-exercise">But first… an exercise!</a></li>
  <li><a href="#instructions-i." id="toc-instructions-i." class="nav-link" data-scroll-target="#instructions-i.">Instructions I.</a>
  <ul class="collapse">
  <li><a href="#hints" id="toc-hints" class="nav-link" data-scroll-target="#hints">Hints:</a></li>
  </ul></li>
  <li><a href="#instructions-ii." id="toc-instructions-ii." class="nav-link" data-scroll-target="#instructions-ii.">Instructions II.</a>
  <ul class="collapse">
  <li><a href="#hints-1" id="toc-hints-1" class="nav-link" data-scroll-target="#hints-1">Hints:</a></li>
  <li><a href="#additional-task" id="toc-additional-task" class="nav-link" data-scroll-target="#additional-task">Additional task:</a></li>
  </ul></li>
  <li><a href="#multivariate-data-methods" id="toc-multivariate-data-methods" class="nav-link" data-scroll-target="#multivariate-data-methods">Multivariate data &amp; methods</a></li>
  <li><a href="#multivariate-data" id="toc-multivariate-data" class="nav-link" data-scroll-target="#multivariate-data">Multivariate data</a>
  <ul class="collapse">
  <li><a href="#division-based-on-number-of-studied-variables" id="toc-division-based-on-number-of-studied-variables" class="nav-link" data-scroll-target="#division-based-on-number-of-studied-variables">Division based on number of studied variables</a></li>
  </ul></li>
  <li><a href="#dimensionality-reduction" id="toc-dimensionality-reduction" class="nav-link" data-scroll-target="#dimensionality-reduction">Dimensionality reduction</a></li>
  <li><a href="#the-curse-of-higher-dimensions" id="toc-the-curse-of-higher-dimensions" class="nav-link" data-scroll-target="#the-curse-of-higher-dimensions">The curse of higher dimensions</a></li>
  <li><a href="#principal-components-analysis" id="toc-principal-components-analysis" class="nav-link" data-scroll-target="#principal-components-analysis">Principal components analysis</a></li>
  <li><a href="#pca-i-data" id="toc-pca-i-data" class="nav-link" data-scroll-target="#pca-i-data">PCA I: Data</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data preparation</a></li>
  <li><a href="#plot-the-original-data" id="toc-plot-the-original-data" class="nav-link" data-scroll-target="#plot-the-original-data">Plot the original data</a></li>
  </ul></li>
  <li><a href="#pca-ii" id="toc-pca-ii" class="nav-link" data-scroll-target="#pca-ii">PCA II</a></li>
  <li><a href="#pca-ii-2" id="toc-pca-ii-2" class="nav-link" data-scroll-target="#pca-ii-2">PCA II-2</a></li>
  <li><a href="#pca-iii-biplot" id="toc-pca-iii-biplot" class="nav-link" data-scroll-target="#pca-iii-biplot">PCA III: Biplot</a></li>
  <li><a href="#pca-iv-the-details" id="toc-pca-iv-the-details" class="nav-link" data-scroll-target="#pca-iv-the-details">PCA IV: The details</a></li>
  <li><a href="#pca-iv-the-details-1" id="toc-pca-iv-the-details-1" class="nav-link" data-scroll-target="#pca-iv-the-details-1">PCA IV: The details</a></li>
  <li><a href="#pca-v-custom-plot" id="toc-pca-v-custom-plot" class="nav-link" data-scroll-target="#pca-v-custom-plot">PCA V: Custom plot</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  <li><a href="#clustering-1" id="toc-clustering-1" class="nav-link" data-scroll-target="#clustering-1">Clustering</a>
  <ul class="collapse">
  <li><a href="#clustering-methods" id="toc-clustering-methods" class="nav-link" data-scroll-target="#clustering-methods">Clustering methods</a></li>
  </ul></li>
  <li><a href="#k-means-partitioning" id="toc-k-means-partitioning" class="nav-link" data-scroll-target="#k-means-partitioning">K-means partitioning</a></li>
  <li><a href="#k-means-partitioning-1" id="toc-k-means-partitioning-1" class="nav-link" data-scroll-target="#k-means-partitioning-1">K-means partitioning</a></li>
  <li><a href="#k-means-algorithm" id="toc-k-means-algorithm" class="nav-link" data-scroll-target="#k-means-algorithm">K-means algorithm</a>
  <ul class="collapse">
  <li><a href="#k-means-algorithm-1" id="toc-k-means-algorithm-1" class="nav-link" data-scroll-target="#k-means-algorithm-1">K-means algorithm</a>
  <ul class="collapse">
  <li><a href="#the-process" id="toc-the-process" class="nav-link" data-scroll-target="#the-process">The process:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#some-properties-of-k-means" id="toc-some-properties-of-k-means" class="nav-link" data-scroll-target="#some-properties-of-k-means">Some properties of k-means</a></li>
  <li><a href="#k-means-i-data" id="toc-k-means-i-data" class="nav-link" data-scroll-target="#k-means-i-data">K-means I: Data</a></li>
  <li><a href="#k-means-ii-reduce-dimensions-pca" id="toc-k-means-ii-reduce-dimensions-pca" class="nav-link" data-scroll-target="#k-means-ii-reduce-dimensions-pca">K-means II: Reduce dimensions (PCA)</a></li>
  <li><a href="#k-means-iii-find-optimal-k" id="toc-k-means-iii-find-optimal-k" class="nav-link" data-scroll-target="#k-means-iii-find-optimal-k">K-means III: Find optimal K</a></li>
  <li><a href="#k-means-iv" id="toc-k-means-iv" class="nav-link" data-scroll-target="#k-means-iv">K-means IV</a></li>
  <li><a href="#k-means-v" id="toc-k-means-v" class="nav-link" data-scroll-target="#k-means-v">K-means V</a></li>
  <li><a href="#k-means-vi" id="toc-k-means-vi" class="nav-link" data-scroll-target="#k-means-vi">K-means VI</a></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">Hierarchical clustering</a></li>
  <li><a href="#hierarchical-clustering-1" id="toc-hierarchical-clustering-1" class="nav-link" data-scroll-target="#hierarchical-clustering-1">Hierarchical clustering</a>
  <ul class="collapse">
  <li><a href="#agglomerative-algorithm" id="toc-agglomerative-algorithm" class="nav-link" data-scroll-target="#agglomerative-algorithm">Agglomerative algorithm:</a></li>
  </ul></li>
  <li><a href="#hierarchical-clustering-algorithms" id="toc-hierarchical-clustering-algorithms" class="nav-link" data-scroll-target="#hierarchical-clustering-algorithms">Hierarchical clustering algorithms</a></li>
  <li><a href="#hierarchical-clustering-i-data" id="toc-hierarchical-clustering-i-data" class="nav-link" data-scroll-target="#hierarchical-clustering-i-data">Hierarchical clustering I: Data</a></li>
  <li><a href="#hierarchical-clustering-ii-dendrogram" id="toc-hierarchical-clustering-ii-dendrogram" class="nav-link" data-scroll-target="#hierarchical-clustering-ii-dendrogram">Hierarchical clustering II: Dendrogram</a></li>
  <li><a href="#hierarchical-clustering-iii-clusters" id="toc-hierarchical-clustering-iii-clusters" class="nav-link" data-scroll-target="#hierarchical-clustering-iii-clusters">Hierarchical clustering III: Clusters</a></li>
  <li><a href="#hierarchical-clustering-iv" id="toc-hierarchical-clustering-iv" class="nav-link" data-scroll-target="#hierarchical-clustering-iv">Hierarchical clustering IV</a></li>
  <li><a href="#cluster-linkage-methods-i" id="toc-cluster-linkage-methods-i" class="nav-link" data-scroll-target="#cluster-linkage-methods-i">Cluster linkage methods I</a>
  <ul class="collapse">
  <li><a href="#complete-maximum-linkage" id="toc-complete-maximum-linkage" class="nav-link" data-scroll-target="#complete-maximum-linkage">Complete (maximum) linkage</a></li>
  <li><a href="#single-minimum-linkage" id="toc-single-minimum-linkage" class="nav-link" data-scroll-target="#single-minimum-linkage">Single (minimum) linkage</a></li>
  </ul></li>
  <li><a href="#cluster-linkage-methods-ii" id="toc-cluster-linkage-methods-ii" class="nav-link" data-scroll-target="#cluster-linkage-methods-ii">Cluster linkage methods II</a>
  <ul class="collapse">
  <li><a href="#mean-average-linkage" id="toc-mean-average-linkage" class="nav-link" data-scroll-target="#mean-average-linkage">Mean (average) linkage</a></li>
  <li><a href="#wards-method" id="toc-wards-method" class="nav-link" data-scroll-target="#wards-method">Wards method</a></li>
  </ul></li>
  <li><a href="#differences" id="toc-differences" class="nav-link" data-scroll-target="#differences">Differences</a>
  <ul class="collapse">
  <li><a href="#k-means-partitioning-2" id="toc-k-means-partitioning-2" class="nav-link" data-scroll-target="#k-means-partitioning-2">K-means partitioning</a></li>
  <li><a href="#hierarchical-clustering-2" id="toc-hierarchical-clustering-2" class="nav-link" data-scroll-target="#hierarchical-clustering-2">Hierarchical clustering</a></li>
  </ul></li>
  <li><a href="#comparison-of-k-means-vs-hclust-for-k-2" id="toc-comparison-of-k-means-vs-hclust-for-k-2" class="nav-link" data-scroll-target="#comparison-of-k-means-vs-hclust-for-k-2">Comparison of k-means vs hclust for k = 2</a>
  <ul class="collapse">
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-means clustering</a></li>
  <li><a href="#hierarchical-clustering-3" id="toc-hierarchical-clustering-3" class="nav-link" data-scroll-target="#hierarchical-clustering-3">Hierarchical clustering</a></li>
  </ul></li>
  <li><a href="#comparison-of-k-means-vs-hclust-for-k-3" id="toc-comparison-of-k-means-vs-hclust-for-k-3" class="nav-link" data-scroll-target="#comparison-of-k-means-vs-hclust-for-k-3">Comparison of k-means vs hclust for k = 3</a>
  <ul class="collapse">
  <li><a href="#k-means-clustering-1" id="toc-k-means-clustering-1" class="nav-link" data-scroll-target="#k-means-clustering-1">K-means clustering</a></li>
  <li><a href="#hierarchical-clustering-4" id="toc-hierarchical-clustering-4" class="nav-link" data-scroll-target="#hierarchical-clustering-4">Hierarchical clustering</a></li>
  </ul></li>
  <li><a href="#comparison-of-k-means-vs-hclust-for-k-4" id="toc-comparison-of-k-means-vs-hclust-for-k-4" class="nav-link" data-scroll-target="#comparison-of-k-means-vs-hclust-for-k-4">Comparison of k-means vs hclust for k = 4</a>
  <ul class="collapse">
  <li><a href="#k-means-clustering-2" id="toc-k-means-clustering-2" class="nav-link" data-scroll-target="#k-means-clustering-2">K-means clustering</a></li>
  <li><a href="#hierarchical-clustering-5" id="toc-hierarchical-clustering-5" class="nav-link" data-scroll-target="#hierarchical-clustering-5">Hierarchical clustering</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="stat4arch" class="level1">
<h1>stat4arch</h1>
<p>author: Petr Pajdla &amp; Peter Tkáč autosize: true width: 1920 height: 1080</p>
<p>AES_707: <em>Statistics seminar for archaeologists</em></p>
<!-- <https://support.rstudio.com/hc/en-us/articles/200486468> -->
<!-- =============================================== -->
</section>
<section id="seminar-6" class="level1">
<h1>Seminar 6</h1>
<p>type: section</p>
<p><code>28. 4. 2022</code></p>
Today:
<ul style="color:white;">
<li>
Multivariate statistics
</li><li>
Dimensionality reduction
</li><li>
Clustering
</li></ul>
<!-- =============================================== -->
</section>
<section id="but-first-an-exercise" class="level1">
<h1>But first… an exercise!</h1>
<p>type: section</p>
<p>Imagine you have radiocarbon data from the whole Czech republic and you want to know from which regions are most of the neolithic data comming. In other words, which districts have most neolithic dates.</p>
<hr>
<p>&lt;img src=“./fig/map_14C.png”, style=‘width:80%;’&gt;</p>
</section>
<section id="instructions-i." class="level1">
<h1>Instructions I.</h1>
<ol type="1">
<li>Download dataset <code>Lasoles_14C_database.csv</code> from ZENODO depositary (https://doi.org/10.5281/zenodo.5728242)</li>
<li>Open the dataset in Rstudio (<code>read.csv</code>).</li>
<li>Explore the dataset. Find out how many observations and variables there are etc.</li>
<li>Try to identify the variable which represents uncalibrated radiocarbon dates.</li>
</ol>
<section id="hints" class="level2">
<h2 class="anchored" data-anchor-id="hints">Hints:</h2>
<ul>
<li>You can find describtion of the dataset and variables in the article bellow:</li>
</ul>
<blockquote class="blockquote">
<p>Tkáč, P. and Kolář, J., 2021. Towards New Demography Proxies and Regional Chronologies: Radiocarbon Dates from Archaeological Contexts Located in the Czech Republic Covering the Period Between 10,000 BC and AD 1250. Journal of Open Archaeology Data, 9, p.9. DOI: http://doi.org/10.5334/joad.85</p>
</blockquote>
<ul>
<li>Usefull functions: <code>here::here()</code>, <code>ncol()</code>, <code>nrow()</code>, <code>head()</code>, <code>str()</code>.</li>
</ul>
</section>
</section>
<section id="instructions-ii." class="level1">
<h1>Instructions II.</h1>
<ol start="3" type="1">
<li>With the help of the <code>dplyr</code> package, filter data from the Neolithic period and then count number of observation per district. Put the districts in order, from highest to lowest number of the observations.</li>
</ol>
<section id="hints-1" class="level2">
<h2 class="anchored" data-anchor-id="hints-1">Hints:</h2>
<ul>
<li>With the use of <code>str()</code> check the <strong>numeric variables</strong> in your dataframe. If they are a <strong>factor</strong>, you have to change it to numeric by:</li>
</ul>
<p><code>dataframe$variable &lt;- as.numeric(as.character(dataframe$variable))</code></p>
<ul>
<li>To define <strong>Neolithic</strong> use a period between <strong>6500</strong> and <strong>5500</strong> of uncalibred radiocarbon dates.</li>
<li>Useful functions: <code>names()</code>, <code>str()</code>, <code>head()</code>, <code>filter()</code>, <code>summarise()</code>, <code>%&gt;%</code>, <code>arrange()</code>, <code>group_by()</code>.</li>
</ul>
</section>
<section id="additional-task" class="level2">
<h2 class="anchored" data-anchor-id="additional-task">Additional task:</h2>
<ul>
<li>Select three districts with the most of the dates and compare how their numbers differ in activity areas (variable: <code>Activity_CZ</code>). In other words, is there any difference between number of dates coming from graveyards (<code>poh</code>) and from settlements (<code>sid</code>)?</li>
</ul>
</section>
</section>
<section id="multivariate-data-methods" class="level1">
<h1>Multivariate data &amp; methods</h1>
<p>type: section</p>
<!-- ----------------------------------------------- -->
</section>
<section id="multivariate-data" class="level1">
<h1>Multivariate data</h1>
<section id="division-based-on-number-of-studied-variables" class="level3">
<h3 class="anchored" data-anchor-id="division-based-on-number-of-studied-variables">Division based on number of studied variables</h3>
<ul>
<li>Univariate<br>
(one variable per observation);</li>
<li>Bivariate<br>
(two variables);</li>
<li><strong>Multivariate</strong><br>
(also <em>multidimensional</em>, multiple variables).</li>
</ul>
<hr>
<p><img src="fig/mvn.png" style="box-shadow:none; width:100%;"></p>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="dimensionality-reduction" class="level1">
<h1>Dimensionality reduction</h1>
<p>type: sub-section</p>
<!-- ----------------------------------------------- -->
</section>
<section id="the-curse-of-higher-dimensions" class="level1">
<h1>The curse of higher dimensions</h1>
<p>title: false left: 60% incremental: true</p>
<p><img src="fig/curse.png" style="width:100%; box-shadow:none;"></p>
<hr>
<p>The <em>curse</em> of higher dimensions…</p>
<ul>
<li>Computational ineffectivity;</li>
<li>Low data density in higher dimensions;</li>
<li>Problematic visualization, we do not easily cope with more than 3D;</li>
<li>Difficult interpretation <em>and much more</em>.</li>
</ul>
<!-- ----------------------------------------------- -->
</section>
<section id="principal-components-analysis" class="level1">
<h1>Principal components analysis</h1>
<p><strong>Goal:</strong> Find low-dimensional representation of the observations that explain a good fraction of the variation.</p>
<ul>
<li>First principal component is a direction that maximizes the variance of the projected data.</li>
<li>Second PC is orthogonal to the previous one.</li>
</ul>
<p><img src="fig/pca.png" style="width:100%; box-shadow:none;"></p>
<!-- ----------------------------------------------- -->
</section>
<section id="pca-i-data" class="level1">
<h1>PCA I: Data</h1>
<p>left: 60% incremental: true</p>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data preparation</h3>
<ul>
<li>Works with numeric data only.</li>
<li>Format the input as a <strong>matrix</strong>…</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"DartPoints"</span>, <span class="at">package =</span> <span class="st">"archdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> DartPoints <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Length, Width, Thickness, Weight) <span class="sc">%&gt;%</span> <span class="co"># select columns</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="co"># format as a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set row names with IDs</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dp) <span class="ot">&lt;-</span> DartPoints<span class="sc">$</span>Catalog</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dp, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>        Length Width Thickness Weight
41-0322   42.8  15.8       5.8    3.6
35-2946   40.5  17.4       5.8    4.5
35-2921   37.5  16.3       6.1    3.6
36-3487   40.3  16.1       6.3    4.0</code></pre>
<hr>
</section>
<section id="plot-the-original-data" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-original-data">Plot the original data</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/pca2-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk pca2</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="pca-ii" class="level1">
<h1>PCA II</h1>
<p>incremental: true</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dp_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(dp)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dp_pca</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Standard deviations (1, .., p=4):
[1] 13.937973  3.238177  1.633327  1.192596

Rotation (n x k) = (4 x 4):
                 PC1        PC2        PC3         PC4
Length    0.90926230  0.3813173  0.1663782  0.01255058
Width     0.30499443 -0.8831253  0.3562343  0.01285657
Thickness 0.06682732 -0.0564513 -0.1616860 -0.98295728
Weight    0.27523551 -0.2673951 -0.9051371  0.18295404</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dp_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Importance of components:
                           PC1     PC2     PC3     PC4
Standard deviation     13.9380 3.23818 1.63333 1.19260
Proportion of Variance  0.9302 0.05021 0.01277 0.00681
Cumulative Proportion   0.9302 0.98042 0.99319 1.00000</code></pre>
</section>
<section id="pca-ii-2" class="level1">
<h1>PCA II-2</h1>
<p>title: false</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dp_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/pca4-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk pca4</figcaption>
</figure>
</div>
<p><em>Scree</em> plot</p>
<ul>
<li>Shows the amount of variation explained by each PC.</li>
</ul>
<!-- ----------------------------------------------- -->
</section>
<section id="pca-iii-biplot" class="level1">
<h1>PCA III: Biplot</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(dp_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/pca5-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk pca5</figcaption>
</figure>
</div>
<hr>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ggbiplot<span class="sc">::</span><span class="fu">ggbiplot</span>(dp_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/pca6-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk pca6</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
<section id="pca-iv-the-details" class="level1">
<h1>PCA IV: The details</h1>
<p>incremental: true</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># structure of the prcomp object</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dp_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>List of 5
 $ sdev    : num [1:4] 13.94 3.24 1.63 1.19
 $ rotation: num [1:4, 1:4] 0.9093 0.305 0.0668 0.2752 0.3813 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:4] "Length" "Width" "Thickness" "Weight"
  .. ..$ : chr [1:4] "PC1" "PC2" "PC3" "PC4"
 $ center  : Named num [1:4] 49.33 22.08 7.27 7.64
  ..- attr(*, "names")= chr [1:4] "Length" "Width" "Thickness" "Weight"
 $ scale   : logi FALSE
 $ x       : num [1:91, 1:4] -9.06 -10.42 -13.71 -11.1 -20.24 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:91] "41-0322" "35-2946" "35-2921" "36-3487" ...
  .. ..$ : chr [1:4] "PC1" "PC2" "PC3" "PC4"
 - attr(*, "class")= chr "prcomp"</code></pre>
</section>
<section id="pca-iv-the-details-1" class="level1">
<h1>PCA IV: The details</h1>
<p>title: false</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the coordinates</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dp_pca_x <span class="ot">&lt;-</span> dp_pca<span class="sc">$</span>x</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dp_pca_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>               PC1       PC2         PC3        PC4
41-0322  -9.063678  4.217119  0.57461646 0.54402974
35-2946 -10.419278  1.686433 -0.05270198 0.70039255
35-2921 -13.710223  1.737639 -0.17757672 0.18905277
36-3487 -11.101828  2.863704 -0.17735660 0.09821324
36-3321 -20.238281 -1.133789  0.47561971 1.93910904
35-2959  -9.946694  3.209080  1.58242087 2.10559068</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(dp_pca_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] "matrix" "array" </code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dp_pca_x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dp_pca_x)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(dp_pca_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] "data.frame"</code></pre>
<!-- ----------------------------------------------- -->
</section>
<section id="pca-v-custom-plot" class="level1">
<h1>PCA V: Custom plot</h1>
<p>left: 65%</p>
<p><img src="fig/pca_dp.png"></p>
<hr>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dp_pca_x <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> DartPoints<span class="sc">$</span>Name</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(PC1, PC2, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> type)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- =============================================== -->
</section>
<section id="clustering" class="level1">
<h1>Clustering</h1>
<p>type: sub-section</p>
<hr>
<p><img src="fig/clustering.jpeg" style="width:60%;"></p>
<!-- ----------------------------------------------- -->
</section>
<section id="clustering-1" class="level1">
<h1>Clustering</h1>
<p>left: 76% incremental: true</p>
<ul>
<li>Broad set of techniques for finding <strong>subgroups</strong>.</li>
<li>Observations <strong>within groups are quite similar to each other</strong> and observations <strong>in different groups quite different from each other</strong>.</li>
</ul>
<section id="clustering-methods" class="level3">
<h3 class="anchored" data-anchor-id="clustering-methods">Clustering methods</h3>
<ul>
<li>Partitioning: <strong>k-means clustering</strong></li>
<li>Agglomerative/divisive: <strong>herarchical clustering</strong></li>
<li>Model-based: mixture models</li>
</ul>
<hr>
<p><img src="fig/kmeans.jpeg"><br>
<img src="fig/hierarchical_clust.png"></p>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="k-means-partitioning" class="level1">
<h1>K-means partitioning</h1>
<p>type: sub-section</p>
<hr>
<p><img src="fig/kebab_kiosks.jpg"></p>
<!-- ----------------------------------------------- -->
</section>
<section id="k-means-partitioning-1" class="level1">
<h1>K-means partitioning</h1>
<ul>
<li>Simple approach to partitioning a data set into <strong>K</strong> distinct, non-overlapping clusters.</li>
<li><strong>K</strong> is specified beforehand.</li>
</ul>
<img src="fig/kmeans_nr_K.png" style="width:76%;"><br>

<p style="font-size:60%;">
(James et al.&nbsp;2013)
</p>
<!-- ----------------------------------------------- -->
</section>
<section id="k-means-algorithm" class="level1">
<h1>K-means algorithm</h1>
<p>left: 42% title: false incremental: true</p>
<section id="k-means-algorithm-1" class="level2">
<h2 class="anchored" data-anchor-id="k-means-algorithm-1">K-means algorithm</h2>
<ul>
<li><em>K</em> … number of clusters.</li>
</ul>
<section id="the-process" class="level3">
<h3 class="anchored" data-anchor-id="the-process">The process:</h3>
<ol type="1">
<li><strong>Randomly</strong> assign each observation to groups 1 to <em>K</em>;</li>
<li>For each of <em>K</em> clusters, derive its <strong>centroid</strong> (midpoint);</li>
<li><strong>Reassign</strong> each observation into a cluster whose centroid is the <strong>closest</strong>;</li>
<li>Iterate until stability in cluster assignments is reached (<em>local vs global optima</em>).</li>
</ol>
<hr>
<img src="fig/kmeans_algorithm.png" style="width:80%;"><br>

<p style="font-size:60%;">
(James et al.&nbsp;2013)
</p>
<!-- ----------------------------------------------- -->
</section>
</section>
</section>
<section id="some-properties-of-k-means" class="level1">
<h1>Some properties of k-means</h1>
<ul>
<li>Standard algorithm for k-means clustering is using <strong>Euclidean distance</strong>.</li>
<li>Different <strong>local optima</strong> (stability) can be reached.</li>
</ul>
<p><img src="fig/kmeans_optima.png" style="box-shadow:none;"></p>
<hr>
<ul>
<li><strong>Number of clusters</strong> <em>K</em> must be specified beforehand.
<ul>
<li>Elbow method;</li>
<li>Silhouette method etc.</li>
</ul></li>
</ul>
<p><img src="fig/elbow.png" style="width:50%;"></p>
<!-- ----------------------------------------------- -->
</section>
<section id="k-means-i-data" class="level1">
<h1>K-means I: Data</h1>
<p>incremental: true</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Fibulae, <span class="at">package =</span> <span class="st">"archdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create matrix</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fib <span class="ot">&lt;-</span> Fibulae <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tot.len =</span> Length, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bow.hei =</span> BH,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">foot.len =</span> FL</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>     tot.len bow.hei foot.len
[1,]     114      24       93
[2,]      35       7       21
[3,]      60      15       33
[4,]      74      26       23
[5,]      68      23       20
[6,]      55      15       27</code></pre>
<hr>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/km2-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk km2</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
<section id="k-means-ii-reduce-dimensions-pca" class="level1">
<h1>K-means II: Reduce dimensions (PCA)</h1>
<p>incremental: true left: 60%</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scale + PCA</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fib_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">scale</span>(fib))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of a PCA</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fib_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Importance of components:
                          PC1    PC2     PC3
Standard deviation     1.4691 0.8941 0.20585
Proportion of Variance 0.7194 0.2665 0.01412
Cumulative Proportion  0.7194 0.9859 1.00000</code></pre>
<hr>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fib_pca<span class="sc">$</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/km4-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk km4</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
<section id="k-means-iii-find-optimal-k" class="level1">
<h1>K-means III: Find optimal K</h1>
<ul>
<li>Package <code>factoextra</code>.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_nbclust</span>(fib_pca<span class="sc">$</span>x, kmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/km5-0-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk km5-0</figcaption>
</figure>
</div>
</section>
<section id="k-means-iv" class="level1">
<h1>K-means IV</h1>
<p>incremental: true</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fib_km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(fib_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">2</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>fib_km</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>K-means clustering with 2 clusters of sizes 24, 6

Cluster means:
         PC1          PC2           PC3
1  0.6099434 -0.007314937 -0.0001198279
2 -2.4397737  0.029259748  0.0004793116

Clustering vector:
 [1] 2 1 1 2 1 1 1 1 1 1 2 2 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 2

Within cluster sum of squares by cluster:
[1] 22.13457 20.21529
 (between_SS / total_SS =  51.3 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
<!-- ----------------------------------------------- -->
</section>
<section id="k-means-v" class="level1">
<h1>K-means V</h1>
<p>incremental: true left: 60%</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster assignment</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fib_km<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] 2 1 1 2 1 1 1 1 1 1 2 2 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 2</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame with clusters</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>fib_df <span class="ot">&lt;-</span> fib_pca<span class="sc">$</span>x <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">clust =</span> fib_km<span class="sc">$</span>cluster)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fib_df, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>          PC1         PC2         PC3 clust
1 -4.22727376  0.03044856  0.60841190     2
2  1.76360759  1.78652460 -0.05839999     1
3 -0.08164798  0.43974905 -0.05057241     1
4 -1.28463323 -2.07589875 -0.24087960     2</code></pre>
<hr>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fib_df <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(PC1, PC2, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">factor</span>(clust))) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/km7-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk km7</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
<section id="k-means-vi" class="level1">
<h1>K-means VI</h1>
<p>title: false</p>
<p><img src="fig/kmeans_out.png"></p>
<!-- ----------------------------------------------- -->
</section>
<section id="hierarchical-clustering" class="level1">
<h1>Hierarchical clustering</h1>
<p>type: sub-section</p>
<!-- ----------------------------------------------- -->
</section>
<section id="hierarchical-clustering-1" class="level1">
<h1>Hierarchical clustering</h1>
<p>incremental: true</p>
<ul>
<li><p>The number of clusters is not specified beforehand.</p></li>
<li><p>Output is a <strong>dendrogram</strong> - a hierarchical structure visualizing the cluster growth.</p></li>
<li><p>Starts with a distance matrix.</p></li>
</ul>
<section id="agglomerative-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="agglomerative-algorithm">Agglomerative algorithm:</h3>
<ol type="1">
<li>Put each object in its own cluster;</li>
<li>Join the clusters that are the closest;</li>
<li>Iterate until a single cluster encompassing all objects is reached.</li>
</ol>
<hr>
<section id="agglomerative" class="level4">
<h4 class="anchored" data-anchor-id="agglomerative">Agglomerative:</h4>
<ul>
<li>Builds the hierarchy of clusters from <strong>bottom-up</strong> until a single cluster is reached.</li>
</ul>
</section>
<section id="divisive" class="level4">
<h4 class="anchored" data-anchor-id="divisive">Divisive:</h4>
<ul>
<li>Divides a single large cluster into individual objects (<strong>top-down</strong>).</li>
</ul>
<p><img src="fig/hierarchical_clust2.png" style="width:80%;"></p>
<!-- ----------------------------------------------- -->
</section>
</section>
</section>
<section id="hierarchical-clustering-algorithms" class="level1">
<h1>Hierarchical clustering algorithms</h1>
<p>title: false</p>
<p><img src="fig/hierarchical_algorithm.png" style="width:90%; box-sahdow:none;"></p>
<!-- ----------------------------------------------- -->
</section>
<section id="hierarchical-clustering-i-data" class="level1">
<h1>Hierarchical clustering I: Data</h1>
<p>left: 40% incremental: true</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data set same as in k-means</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>     tot.len bow.hei foot.len
[1,]     114      24       93
[2,]      35       7       21
[3,]      60      15       33
[4,]      74      26       23
[5,]      68      23       20
[6,]      55      15       27</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>fib_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(fib) </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(fib_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] "dist"</code></pre>
<hr>
<div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(fib_dist)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>          1         2        3         4
1   0.00000 108.23123 81.22192 80.647381
2 108.23123   0.00000 28.86174 43.428102
3  81.22192  28.86174  0.00000 20.420578
4  80.64738  43.42810 20.42058  0.000000
5  86.29021  36.68787 17.23369  7.348469
6  88.98314  22.36068  7.81025 22.315914</code></pre>
<ul>
<li>Matrix with <em>n</em> rows and <em>n</em> columns.</li>
<li>Pair-wise distances between the objects.</li>
<li>Notice the 0 on diagonal, ie. distance to itself is 0.</li>
</ul>
<!-- ----------------------------------------------- -->
</section>
<section id="hierarchical-clustering-ii-dendrogram" class="level1">
<h1>Hierarchical clustering II: Dendrogram</h1>
<div class="sourceCode" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fib_hclust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(fib_dist)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>fib_hclust</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>
Call:
hclust(d = fib_dist)

Cluster method   : complete 
Distance         : euclidean 
Number of objects: 30 </code></pre>
<hr>
<div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fib_hclust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/hclust5-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk hclust5</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
<section id="hierarchical-clustering-iii-clusters" class="level1">
<h1>Hierarchical clustering III: Clusters</h1>
<p>incremental: true</p>
<ul>
<li>Different options where to <em>cut</em> the dendrogram…</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/hclust6-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk hclust6</figcaption>
</figure>
</div>
<hr>
<ul>
<li><code>cutree(x, k, h)</code> function:
<ul>
<li>specify <strong>k</strong> - number of cluster;</li>
<li>specify <strong>h</strong> - height where to cut.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>h35 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(fib_hclust, <span class="at">h =</span> <span class="dv">35</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>h35</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] 1 2 3 4 4 3 2 2 3 2 4 4 3 2 2 2 2 2 2 3 1 3 2 2 2 3 3 2 2 1</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(fib_hclust, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>k3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] 1 2 3 3 3 3 2 2 3 2 3 3 3 2 2 2 2 2 2 3 1 3 2 2 2 3 3 2 2 1</code></pre>
<!-- ----------------------------------------------- -->
</section>
<section id="hierarchical-clustering-iv" class="level1">
<h1>Hierarchical clustering IV</h1>
<div class="sourceCode" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fib, <span class="at">col =</span> h35)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/hclust9-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk hclust9</figcaption>
</figure>
</div>
<hr>
<div class="sourceCode" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fib, <span class="at">col =</span> k3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/hclust10-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk hclust10</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
<section id="cluster-linkage-methods-i" class="level1">
<h1>Cluster linkage methods I</h1>
<section id="complete-maximum-linkage" class="level3">
<h3 class="anchored" data-anchor-id="complete-maximum-linkage">Complete (maximum) linkage</h3>
<ul>
<li>Largest distance between clusters.</li>
<li><code>method = "complete"</code></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/link1-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk link1</figcaption>
</figure>
</div>
<hr>
</section>
<section id="single-minimum-linkage" class="level3">
<h3 class="anchored" data-anchor-id="single-minimum-linkage">Single (minimum) linkage</h3>
<ul>
<li>Smallest distance between clusters.</li>
<li><code>method = "single"</code></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/link2-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk link2</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="cluster-linkage-methods-ii" class="level1">
<h1>Cluster linkage methods II</h1>
<section id="mean-average-linkage" class="level3">
<h3 class="anchored" data-anchor-id="mean-average-linkage">Mean (average) linkage</h3>
<ul>
<li>Mean distance between clusters.</li>
<li><code>method = "average"</code></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/link3-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk link3</figcaption>
</figure>
</div>
<hr>
</section>
<section id="wards-method" class="level3">
<h3 class="anchored" data-anchor-id="wards-method">Wards method</h3>
<ul>
<li>Minimizes total within cluster variance.</li>
<li><code>method = "ward.D2"</code></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/link4-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk link4</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="differences" class="level1">
<h1>Differences</h1>
<p>title: false type: prompt</p>
<section id="k-means-partitioning-2" class="level2">
<h2 class="anchored" data-anchor-id="k-means-partitioning-2">K-means partitioning</h2>
<ul>
<li>Pre-specified number of clusters.</li>
<li>Clusters may vary (different <em>local optima</em>).</li>
<li>Best when groups in data are <em>hyper</em>-spheres.</li>
</ul>
<p><img src="fig/kmeans.jpeg"></p>
<hr>
</section>
<section id="hierarchical-clustering-2" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-clustering-2">Hierarchical clustering</h2>
<ul>
<li>Variable cluster numbers.</li>
<li>Clusters are stable.</li>
<li>Any shape of data distribution.</li>
</ul>
<p><img src="fig/hierarchical_clust.png" style="width:60%;"></p>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="comparison-of-k-means-vs-hclust-for-k-2" class="level1">
<h1>Comparison of k-means vs hclust for k = 2</h1>
<p>type: prompt</p>
<section id="k-means-clustering" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering">K-means clustering</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/unnamed-chunk-5-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk unnamed-chunk-5</figcaption>
</figure>
</div>
<hr>
</section>
<section id="hierarchical-clustering-3" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-clustering-3">Hierarchical clustering</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/unnamed-chunk-6-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk unnamed-chunk-6</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="comparison-of-k-means-vs-hclust-for-k-3" class="level1">
<h1>Comparison of k-means vs hclust for k = 3</h1>
<p>type: prompt</p>
<section id="k-means-clustering-1" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering-1">K-means clustering</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/unnamed-chunk-7-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk unnamed-chunk-7</figcaption>
</figure>
</div>
<hr>
</section>
<section id="hierarchical-clustering-4" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-clustering-4">Hierarchical clustering</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/unnamed-chunk-8-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk unnamed-chunk-8</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->
</section>
</section>
<section id="comparison-of-k-means-vs-hclust-for-k-4" class="level1">
<h1>Comparison of k-means vs hclust for k = 4</h1>
<p>type: prompt</p>
<section id="k-means-clustering-2" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering-2">K-means clustering</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/unnamed-chunk-9-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk unnamed-chunk-9</figcaption>
</figure>
</div>
<hr>
</section>
<section id="hierarchical-clustering-5" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-clustering-5">Hierarchical clustering</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seminar6-figure/unnamed-chunk-10-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">plot of chunk unnamed-chunk-10</figcaption>
</figure>
</div>
<!-- ----------------------------------------------- -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://quarto.org/">Build with quarto.</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/petrpajdla/stat4arch/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>